<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_8_5_3.dtd'>
<agent name='(Initialize ThreadIds)' xmlns='http://www.lotus.com/dxl' version='8.5'
 maintenanceversion='3.0' replicaid='80257AC50035BEE2' hide='v3' publicaccess='false'
 designerversion='6' language='en' comment='If you want to convert existing documents such that they are identified as threads, run this once against all documents.'>
<noteinfo noteid='18a' unid='280FE73D62B5263D85256203005CDE72' sequence='24'>
<created><datetime dst='true'>19950724T125422,58-04</datetime></created>
<modified><datetime>20130219T091823,06+00</datetime></modified>
<revised><datetime>20130219T091823,05+00</datetime></revised>
<lastaccessed><datetime>20130219T091823,06+00</datetime></lastaccessed>
<addedtofile><datetime>20121129T094703,30+00</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name><name
>CN=Matt White/O=Exhilarate</name></updatedby>
<wassignedby><name>CN=Matt White/O=Exhilarate</name></wassignedby>
<designchange><datetime>20130219T091819,56+00</datetime></designchange>
<trigger type='agentlist'/>
<documentset type='all'/><code event='options'><lotusscript>Option Public

</lotusscript></code><code event='declarations'><lotusscript>Dim s As NotesSession
Dim db As NotesDatabase
Dim view As NotesView 
Dim note As NotesDocument
Dim parent As NotesDocument
</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	
	Set s = New NotesSession
	Set db = s.CurrentDatabase
	Set view = db.GetView("($All)")
	Set note = view.GetFirstDocument
	
	Do Until note Is Nothing
		FormName = note.Form
		Subject = note.Subject
		Select Case FormName(0)
		Case "MainTopic", "Main Topic"
			note.NewsLetterSubject = Subject(0)
		Case "Response", "AnonymousResponse", "Response (Anonymous)"
			OriginalSubject = note.OriginalSubject
			note.NewsLetterSubject = Subject(0) &amp; "  (Response to:  -" &amp; OriginalSubject(0) &amp; "-)"
		Case "ResponseToResponse", "Response to Response"
			OriginalSubject = note.OriginalSubject
			note.NewsLetterSubject = Subject(0) &amp; "  (Response to Response to:  -" &amp; OriginalSubject(0) &amp; "-)"
		End Select
		If note.IsResponse Then
			Set parent = view.GetParentDocument(note)              
			Do Until parent.IsResponse = False
				Set parent = view.GetParentDocument(parent)              
			Loop
			NewId = parent.ThreadId
		Else
			NewId = Evaluate("@Unique")             
		End If
		note.ThreadId = NewId(0)
		note.save True, True
		Set note = view.GetNextDocument(note)
	Loop
	
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0'>
<agentmodified><datetime dst='true'>20011016T111416,17-04</datetime></agentmodified></rundata></agent>

