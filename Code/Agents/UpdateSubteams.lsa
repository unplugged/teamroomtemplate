<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_8_5_3.dtd'>
<agent name='(UpdateSubteams)' xmlns='http://www.lotus.com/dxl' version='8.5'
 maintenanceversion='3.0' replicaid='80257AC50035BEE2' hide='v3' publicaccess='false'
 designerversion='6' language='en'>
<noteinfo noteid='436' unid='121E5C42FC6EA90B85256ACD0061F505' sequence='15'>
<created><datetime dst='true'>20010920T134957,17-04</datetime></created>
<modified><datetime>20121129T094705,96+00</datetime></modified>
<revised><datetime dst='true'>20090617T103850,38-04</datetime></revised>
<lastaccessed><datetime>20121129T094705,96+00</datetime></lastaccessed>
<addedtofile><datetime>20121129T094705,96+00</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></updatedby>
<wassignedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></wassignedby>
<designchange><datetime dst='true'>20090617T103848,87-04</datetime></designchange>
<trigger type='agentlist'/>
<documentset type='runonce'/><code event='options'><lotusscript>Option Public

</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	Dim s As New notessession
	Dim doc As notesdocument
	Set db = s.currentdatabase
	Set view = db.getview("SubteamLookup")
	
	
	Set doc = view.getfirstdocument
	While Not doc Is Nothing
		Call doc.computewithform(0,0)
		Call CrAltMembers(doc)		
		Call doc.save(False,False)
		Set doc = view.getnextdocument(doc)
	Wend
	
	
End Sub
</lotusscript></code><code event='CrAltMembers'><lotusscript>Sub CrAltMembers(note As notesdocument)
	Dim s As New notessession
	Dim db As notesdatabase
	Dim view As notesview
	Dim altSelection As Variant
'	Dim note As notesdocument
	Dim TMNote As notesdocument
	Dim uBoundSel As Integer
	Dim getAltName As Variant
	Dim commonName As String
	
	Set db = s.currentdatabase
	Set view = db.getview("PeopleLookup")
'	Set note = 	source.document
	AltSelection = note.getitemvalue("AltNameSelection")
	uBoundSel = Ubound(AltSelection)
	Dim count As Integer
	
	Redim AltMembers(uBoundSel) As Variant
	
	count = 0
	
'determine alternate names for all members selected	
	Forall x In AltSelection
		
		Set TMNote = view.getdocumentbykey(x)
		If TMNote Is Nothing Then 
			Goto GetNextP
		Else
			getAltName = TMNote.getitemvalue("GetAlternateName")	
		End If
		
		AltMembers(count) = getAltName(0)
GetNextP:
		count = count + 1
	End Forall
	
	Dim b As Variant
	b = Fulltrim(AltMembers)
	
	Call note.replaceitemvalue("AltNameMembers", b)	
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0'>
<agentmodified><datetime dst='true'>20011016T111344,23-04</datetime></agentmodified></rundata></agent>

