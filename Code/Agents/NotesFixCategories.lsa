<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_8_5_3.dtd'>
<agent name='(NotesFixCategories)' xmlns='http://www.lotus.com/dxl' version='8.5'
 maintenanceversion='3.0' replicaid='80257AC50035BEE2' hide='v3' publicaccess='false'
 designerversion='6' language='en' comment='This is run via the &apos;Map Categories&apos; button in the map cat. form'>
<noteinfo noteid='27e' unid='DB3C885A72F7CD7985256610003AD45C' sequence='18'>
<created><datetime dst='true'>19980526T064234,52-04</datetime></created>
<modified><datetime>20130115T081350,01+00</datetime></modified>
<revised><datetime>20130115T081350,00+00</datetime></revised>
<lastaccessed><datetime>20130115T081350,01+00</datetime></lastaccessed>
<addedtofile><datetime>20121129T094703,90+00</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name><name
>CN=Matt White/O=Exhilarate</name></updatedby>
<wassignedby><name>CN=Matt White/O=Exhilarate</name></wassignedby>
<designchange><datetime>20130115T081346,99+00</datetime></designchange>
<trigger type='agentlist'/>
<documentset type='runonce'/><code event='options'><lotusscript>Option Public
Use "wStringResource"
Option Declare

</lotusscript></code><code event='declarations'><lotusscript>Dim oldcat As Variant
Dim currentcat As Variant
Dim db As notesdatabase
Dim selected As Integer

</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	Dim s As New notessession
	Dim uiwork As New notesuiworkspace
	Dim uidoc As notesuidocument
	Dim note As notesdocument
	
	Set db =  s.currentdatabase	
	Set uidoc  = uiwork.currentdocument
	Set note = uidoc.document
	
	oldcat = note.getitemvalue("OldCat")
	currentcat = note.getitemvalue("CurrentCat")
	selected = Ubound(oldcat)
	
	If oldcat(0) = "" Then
		Messagebox getstring(33), 16, getstring(37)
		Exit Sub
	Elseif currentcat(0) = "" Then
		Messagebox getstring(34), 16, getstring(37)
		Exit Sub
	End If
	
	MapCategories
	
	If selected = 0 Then
		Msgbox getstring(35), 64, getstring(38)
	Else
		Msgbox getstring(36), 64, getstring(38)
	End If
	
	Call uidoc.fieldsettext("OldCat", "")
	Call uidoc.fieldsettext("CurrentCat", "")
	Call uidoc.refresh
End Sub

</lotusscript></code><code event='MapCategories'><lotusscript>Sub MapCategories
	Dim View As NotesView
	Dim Item As NotesItem
	Dim i As Integer
	Dim cats As Variant
	Dim Doc As NotesDocument
	
	Set View=Db.GetView("($All)")
	Set Doc= View.GetFirstDocument
	
	While Not(doc Is Nothing)
		cats=Doc.GetItemValue("Categories")
		i = 0		
		
		Forall x In cats
			Forall y In OldCat
				If Lcase(x) = Lcase(y) Then
					cats(i) = CurrentCat(0)
					Set item = doc.replaceitemvalue("Categories", cats)
				End If
			End Forall
			i= i+1
		End Forall
		Call Doc.Save( True, True)        		
		Set Doc=View.GetNextdocument(Doc)
	Wend
	
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0'>
<agentmodified><datetime dst='true'>20011016T111400,06-04</datetime></agentmodified></rundata></agent>

