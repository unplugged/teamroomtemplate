<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE agent SYSTEM 'xmlschemas/domino_8_5_3.dtd'>
<agent name='(InactiveToActive)' xmlns='http://www.lotus.com/dxl' version='8.5'
 maintenanceversion='3.0' replicaid='80257AC50035BEE2' hide='v3' runaswebuser='true'
 publicaccess='false' designerversion='6' language='en'>
<noteinfo noteid='22e' unid='97CFC7CE8BC54A9F052568240049BE6E' sequence='18'>
<created><datetime>19991109T082528,78-05</datetime></created>
<modified><datetime>20121129T094703,70+00</datetime></modified>
<revised><datetime dst='true'>20090617T103848,10-04</datetime></revised>
<lastaccessed><datetime>20121129T094703,70+00</datetime></lastaccessed>
<addedtofile><datetime>20121129T094703,70+00</datetime></addedtofile></noteinfo>
<updatedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></updatedby>
<wassignedby><name>CN=Lotus Notes Template Development/O=Lotus Notes</name></wassignedby>
<designchange><datetime dst='true'>20090617T103847,49-04</datetime></designchange>
<trigger type='agentlist'/>
<documentset type='selected'/><code event='options'><lotusscript>Option Public
Option Declare
Use "wStringResource"

</lotusscript></code><code event='declarations'><lotusscript>'SetActiveToInactive: 



</lotusscript></code><code event='initialize'><lotusscript>Sub Initialize
	
	Dim session As New notessession
	Dim db As notesdatabase
	Dim doc As notesdocument
	Set db  = session.currentdatabase
	Dim collection As notesdocumentcollection
	Set collection = db.UnprocessedDocuments
	Dim i As Integer
	Dim item As notesitem	
	Dim item1 As notesitem
	
	If collection.Count &lt; 1 Then
		Msgbox getSTring(55)
		Exit Sub
	End If
	
	For i = 1 To collection.Count
		Set doc = collection.GetNthDocument( i )
		Set item1 = doc.getfirstItem("DateFiled")	
		Dim form As Variant
		Dim valFile As Variant
		form = doc.getitemvalue("form")
		
		If form(0) &lt;&gt; "MainTopic" And doc.getitemvalue("FileThisStatusDoc")(0) = "0" Then
			Msgbox "This document is already active."
			Exit Sub
		Elseif  item1 Is Nothing And form(0) = "MainTopic" Then
			Msgbox "This document is already active."
			Exit Sub			
		End If
		
		
		
		If doc.form(0) = "MainTopic" Then
			Set item = doc.getfirstItem("FileByDate")
			Call item.remove		
			Set item = doc.getfirstItem("DateFiled")
			Call item.remove
			Set item = doc.getfirstItem("ViewDateFiled")
			Call item.remove
			Call doc.replaceitemvalue("NeverFile", "1")
			Call doc.replaceitemvalue("Status", "1")
		Else
			Call doc.replaceitemvalue("FileThisStatusDoc", "0")
			Call doc.replaceitemvalue("Status", "1")
		End If	
		Call doc.computewithform(0,0)
		Call doc.save(True, True, True)    
	Next		
	
End Sub</lotusscript></code>
<rundata processeddocs='0' exitcode='0'>
<agentmodified><datetime dst='true'>20020724T082228,01-04</datetime></agentmodified></rundata></agent>

